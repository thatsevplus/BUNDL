{%- comment -%}
  Local producers â€” Sourcing story (list of producers; map optional via blocks)
  White-label: producer blocks (name, ingredient, image, distance, story).
  Map can be added later with Leaflet/Mapbox; for now list view works on all devices.
{%- endcomment -%}

<section class="section-padding" data-section-id="{{ section.id }}">
  <div class="gingr-container">
    {% if section.settings.heading != blank %}
      <h2 class="text-2xl md:text-3xl font-bold text-heading mb-4 text-center">{{ section.settings.heading }}</h2>
    {% endif %}
    {% if section.settings.description != blank %}
      <div class="rte text-body text-center max-w-2xl mx-auto mb-10">{{ section.settings.description }}</div>
    {% endif %}
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
      {% for block in section.blocks %}
        {% case block.type %}
          {% when 'producer' %}
            <div class="rounded-xl overflow-hidden bg-white/5 border border-white/10" {{ block.shopify_attributes }}>
              {% if block.settings.image %}
                <div class="aspect-[4/3]">
                  {{ block.settings.image | image_url: width: 600 | image_tag: class: 'w-full h-full object-cover', loading: 'lazy' }}
                </div>
              {% endif %}
              <div class="p-6">
                <h3 class="text-lg font-semibold text-heading">{{ block.settings.name }}</h3>
                <p class="text-sm text-accent mt-1">{{ block.settings.ingredient }}</p>
                {% if block.settings.distance != blank %}
                  <p class="text-xs text-subheading mt-2">{{ block.settings.distance }}</p>
                {% endif %}
                {% if block.settings.story != blank %}
                  <div class="rte text-sm text-body mt-3">{{ block.settings.story }}</div>
                {% endif %}
              </div>
            </div>
        {% endcase %}
      {% endfor %}
    </div>
  </div>
</section>

{% schema %}
{
  "name": "Local producers",
  "tag": "section",
  "settings": [
    {
      "type": "text",
      "id": "heading",
      "label": "Heading",
      "default": "Locally sourced ingredients"
    },
    {
      "type": "richtext",
      "id": "description",
      "label": "Description"
    },
    {
      "type": "text",
      "id": "map_center_lat",
      "label": "Map center latitude",
      "default": "40.7128",
      "info": "For future map integration"
    },
    {
      "type": "text",
      "id": "map_center_lng",
      "label": "Map center longitude",
      "default": "-74.0060"
    },
    {
      "type": "range",
      "id": "map_zoom",
      "label": "Map zoom level",
      "min": 1,
      "max": 15,
      "step": 1,
      "default": 10
    }
  ],
  "blocks": [
    {
      "type": "producer",
      "name": "Producer",
      "settings": [
        { "type": "text", "id": "name", "label": "Producer name", "default": "Smith Family Farms" },
        { "type": "text", "id": "ingredient", "label": "Ingredient provided", "default": "Organic ginger" },
        { "type": "image_picker", "id": "image", "label": "Producer image" },
        { "type": "text", "id": "latitude", "label": "Latitude", "default": "40.7128" },
        { "type": "text", "id": "longitude", "label": "Longitude", "default": "-74.0060" },
        { "type": "text", "id": "distance", "label": "Distance from production", "default": "25 miles" },
        { "type": "richtext", "id": "story", "label": "Producer story" }
      ]
    }
  ],
  "presets": [
    { "name": "Local producers", "blocks": [{ "type": "producer" }, { "type": "producer" }] }
  ],
  "disabled_on": { "groups": ["header", "footer"] }
}
{% endschema %}
